<!DOCTYPE html>
<html lang="en" class="min-h-screen">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tanzu Application Platform on a Windows Workstation | Server As Code Dot Com</title>
    <meta name="description" content="A techno-blog for our techno-times">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <link href="/assets/css/main.css" rel="stylesheet">
    <link href="/assets/css/prism.min.css" rel="stylesheet">
    <link href="/assets/css/extra.css" rel="stylesheet">

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <meta name="twitter:site" content="serverascode.com">
    <meta name="twitter:creator" content="Curtis Collicutt">
    
    
        <meta name="twitter:title" content="Tanzu Application Platform on a Windows Workstation">
        
        <meta name="twitter:description" content="My current favorite VMware document is this:

">
        <meta property="og:description" content="My current favorite VMware document is this:

" />
        
        <meta property="og:title" content="Tanzu Application Platform on a Windows Workstation" />
        <meta property="og:type" content="article" />
    
    
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://serverascode.com/img/social/posts/tanzu-application-platform-on-windows-workstation.png">
    <meta property="og:image" content="https://serverascode.com/img/social/posts/tanzu-application-platform-on-windows-workstation.png" />
    
    
    <meta property="og:url" content="https://serverascode.com/2022/04/26/tanzu-application-platform-on-windows-workstation.html" />
    <meta property="og:site_name" content="Server As Code Dot Com" />
    <script defer data-domain="serverascode.com" src="https://plausible.io/js/script.js"></script>
</head>
<body class="font-sans">
    <div class="magazine-container">
        <header>
            <div class="magazine-header">
                <div class="issue-number-dropdown">
                    <button class="issue-number-top dropdown-toggle">
                        ISSUE 263
                        <span class="arrow-down"></span>
                    </button>
                    <div class="dropdown-menu">
                        <div class="dropdown-section">
                            <h3>Navigation</h3>
                            <a href="/">Home</a>
                            <a href="/archive.html">Archive</a>
                            <a href="/feed.xml">RSS Feed</a>
                        </div>
                        <div class="dropdown-section">
                            <h3>Sections</h3>
                            <a href="/#latest-issues">Latest Issues</a>
                            <a href="/#projects">Software Projects</a>
                            <a href="/#tidal-series">Tidal Series</a>
                            <a href="/#connect-with-me">Connect With Me</a>
                            <a href="/#recent-posts">Recent Posts</a>
                        </div>
                        <div class="dropdown-section">
                            <h3>Connect</h3>
                            
                                
                            
                                
                                    <a href="https://tidalseries.com" target="_blank" rel="noopener noreferrer">TIDAL SERIES Newsletter</a>
                                
                            
                                
                                    <a href="https://www.linkedin.com/in/ccollicutt/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
                                
                            
                                
                                    <a href="https://taico.ca" target="_blank" rel="noopener noreferrer">TAICO - The Toronto AI and Cybersecurity Organization</a>
                                
                            
                                
                                    <a href="https://github.com/ccollicutt" target="_blank" rel="noopener noreferrer">GitHub</a>
                                
                            
                                
                                    <a href="https://huggingface.co/ccollicutt" target="_blank" rel="noopener noreferrer">Hugging Face</a>
                                
                            
                                
                            
                        </div>
                    </div>
                </div>
                <div class="magazine-info">
                    <div>Server As Code Dot Com</div>
                    <div class="underline"><a href="/archive.html">ARCHIVE</a></div>
                    <div class="underline">2025 MAY</div>
                    <div class="underline">¥980</div>
                </div>
            </div>
            <p class="magazine-subtitle">A techno-blog for our techno-times</p>
            <a href="/" class="logo-link">
                <img src="/img/logo/logo.png" alt="Server As Code Dot Com" class="logo-image">
            </a>
        </header>

        <div class="content-wrapper">
            <main class="flex-grow px-4 md:px-8 main-content">
                <div class="max-w-4xl mx-auto px-4 mt-8 mb-12">
    <div class="flex justify-center space-x-4">
        
        
        <a href="https://serverascode.com" class="group flex flex-col items-center bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-3" target="_blank" rel="noopener noreferrer">
            <img src="/img/author/curtis.jpg" alt="Curtis Collicutt" class="w-14 h-14 object-cover rounded-full mb-2">
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 text-center">Curtis Collicutt</span>
        </a>
        
        
        
        <a href="https://tidalseries.com" class="group flex flex-col items-center bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-3" target="_blank" rel="noopener noreferrer">
            <img src="/img/cards/tidalseries.png" alt="TIDAL SERIES Newsletter" class="w-14 h-14 object-cover rounded-full mb-2">
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 text-center">TIDAL SERIES Newsletter</span>
        </a>
        
        
        
        <a href="https://www.linkedin.com/in/ccollicutt/" class="group flex flex-col items-center bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-3" target="_blank" rel="noopener noreferrer">
            <img src="/img/cards/linkedin.png" alt="LinkedIn" class="w-14 h-14 object-cover rounded-full mb-2">
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 text-center">LinkedIn</span>
        </a>
        
        
        
        
        
        <a href="https://github.com/ccollicutt" class="group flex flex-col items-center bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-3" target="_blank" rel="noopener noreferrer">
            <img src="/img/cards/github.jpg" alt="GitHub" class="w-14 h-14 object-cover rounded-full mb-2">
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900 text-center">GitHub</span>
        </a>
        
        
        
        
        
        
    </div>
</div>

<article class="prose lg:prose-xl mx-auto">
    <header class="mb-8 text-center not-prose">
        <h1 class="text-4xl md:text-5xl font-extrabold mb-2">Tanzu Application Platform on a Windows Workstation</h1>
        <p class="text-gray-600">
            <time datetime="2022-04-26T00:00:00-04:00">
                April 26, 2022
            </time>
            
        </p>
    </header>

    <div id="toc" class="hidden mb-8 p-4 bg-gray-50 rounded-lg not-prose">
        <h2 class="text-lg font-semibold mb-2">Table of Contents</h2>
        <nav id="toc-content"></nav>
    </div>

    

    <p>My current favorite VMware document is this:</p>

<ul>
  <li><a href="https://tanzu.vmware.com/developer/guides/tanzu-application-platform-local-devloper-install/">Running Tanzu Application Platform Locally on Your Laptop</a></li>
</ul>

<p>If you run through the above how-to document, which is affectionately called TAPonLAP, at the end you will have a functioning <a href="https://tanzu.vmware.com/application-platform">Tanzu Application Platform</a> (TAP) profile-defined environment to use, and it’s all running locally on your personal workstation.</p>

<h2 id="what-is-tap">What is TAP?</h2>

<p>TAP is:</p>

<blockquote>
  <p>…a modular, application-aware platform that provides a rich set of developer tooling and a prepaved path to production to build and deploy software quickly and securely on any compliant public cloud or on-premises Kubernetes cluster. - <a href="https://tanzu.vmware.com/application-platform">VMware Tanzu</a></p>
</blockquote>

<p>Using TAP we get all kinds of interesting and useful modular, Kubernetes native components which can work together, in concert with other tools and systems, to abstract way the complexity, and technical debt, of things like Dockerfiles and Kubernetes manifests, while also providing the ability to secure and understand workloads, even across multiple Kubernetes clusters.</p>

<p>It’s important to understand that TAP isn’t a single binary–it’s not a monolithic thing–instead it’s a collection of tools that can work together, even across multiple Kubernetes clusters. Some TAP components will be deployed in production clusters that run the apps, other pieces will only be deployed into clusters that build images and compile code, and still more parts only need to be deployed locally for a developers inner loop (if desired). We use the concept of profiles to determine what tools get deployed where. Honestly–it’s a new paradigm for Kubernetes based application platforms.</p>

<p>Another thing to keep in mind is that VMware Tanzu is extremely focused on Developer Experience (DX). Because of that focus we care very much about the developers “inner loop”…the things developers do with code before they commit it. With that in mind, the TAPonLAP document is focussed on building a local environment, specifically to meet the needs of that inner loop. I take it a little farther here and deploy most of the TAP components, but this won’t be commonplace, unless someone is learning about all of the components.</p>

<h2 id="my-taponlap-environment">My TAPonLAP Environment</h2>

<p>My main operating system is Linux (how do you know someone runs Linux on their desktop…just wait and they’ll tell you) but I use a Windows workstation for talking to customers with (Zoom, Teams, etc). Because I use Windows when I demonstrate software…well, that software has to run there too. So I’ve spent a fair amount time running through the TAPonLAP document, using the powershell commands, etc, overall making sure I’ve got the best local Windows development environment I can.</p>

<p>What I have:</p>

<ul>
  <li>Windows 10</li>
  <li>Hyper-V enabled</li>
  <li>Minikube</li>
  <li>32GB main memory, but using 12GB for the minikube instance</li>
  <li>Enough disk (I use a Minikube instance with 80GB or more)</li>
  <li>AMD Ryzen 5 3600 6-Core Processor</li>
</ul>

<h2 id="taponlap">TAPonLAP</h2>

<p>Please note: I’m not going to go through the <a href="https://tanzu.vmware.com/developer/guides/tanzu-application-platform-local-devloper-install/">entire document</a> and copy and paste the same commands here. However, I will detail some changes I made for my particular situation. So don’t expect to be able to follow this blog post and get TAP deployed–instead read the TAPonLAP doc, and this post, and then make your own decisions about how best to deploy TAP locally. Keep in mind it’s easy to delete or update TAP and redo the minikube install if needed. This combination of minikube and TAP is a great way to experiment.</p>

<h2 id="minikube-start">Minikube Start</h2>

<p>I use the below. Note that I am adding more disk, I think the default is ~20GB, which should be fine in most situations, but if you run the “full” TAP profile you’ll need more resources.</p>

<pre><code>minikube start `
  --kubernetes-version='1.22.8' `
  --cpus='8' --memory='12g' `
  --driver='hyperv' `
  --disk-size='80g'
</code></pre>

<h2 id="a-note-about-profiles">A Note About Profiles</h2>

<p>TAP is modular. It has many components, and not all of them need to be deployed in every situation. The TAPonLAP document shows the “iterate” profile, but in this blog post I use the “full” profile.</p>

<p>Most people using TAP locally, as part of their inner loop, would not run the full profile. Instead they are iterating on their own code before committing it, and want to make sure it mostly works before the commit, and when the CI system takes over. That is why the “iterate” profile exists.</p>

<h2 id="tap-full-profile">TAP Full Profile</h2>

<p>The TAPonLAP document shows using the iterative profile. Here’s an example full profile.</p>

<blockquote>
  <p>NOTE: This, of course, this will consume more resources that the “iterative” profile.</p>
</blockquote>

<blockquote>
  <p>NOTE: I’m using “example.com” as the domain, which you may or may not want to do.</p>
</blockquote>

<blockquote>
  <p>NOTE: You’ll have to fill in all the image registry information, users, passwords, etc.</p>
</blockquote>

<pre><code>profile: full
ceip_policy_disclosed: true # Installation fails if this is set to 'false'

buildservice:
  kp_default_repository: "&lt;some repository&gt;/tap-inner-loop-1-1-full/build-service"
  kp_default_repository_username: ""
  kp_default_repository_password: ""
  tanzunet_username: ""
  tanzunet_password: ""
  enable_automatic_dependency_updates: true


cnrs:
  domain_name: apps.example.com
  domain_template: "{{.Name}}-{{.Namespace}}.{{.Domain}}"
  provider: local


supply_chain: basic

ootb_supply_chain_basic:
  registry:
    server: "&lt;some repository&gt;"
    repository: "tap-inner-loop-1-1-full/supply-chain"
  gitops:
    ssh_secret: ""

learningcenter:
  ingressDomain: "lc.example.com"

tap_gui:
  service_type: ClusterIP
  ingressEnabled: "true"
  ingressDomain: "example.com"
  app_config:
    app:
      baseUrl: http://tap-gui.example.com
    catalog:
      locations:
        - type: url
          target: https://github.com/sample-accelerators/tanzu-java-web-app/blob/main/catalog/catalog-info.yaml
        - type: url
          target: https://github.com/benwilcock/tap-gui-blank-catalog/blob/main/catalog-info.yaml
    backend:
      baseUrl: http://tap-gui.example.com
      cors:
        origin: http://tap-gui.example.com

metadata_store:
  app_service_type: LoadBalancer

grype:
  namespace: "default"
  targetImagePullSecret: "registry-credentials"

# e.g. App Accelerator specific values go under its name
accelerator:
  server:
    service_type: ClusterIP

contour:
  envoy:
    service:
      type: LoadBalancer
</code></pre>

<h2 id="once-tap-deploys">Once TAP deploys</h2>

<p>We should see the below.</p>

<pre><code>PS C:\Windows\system32&gt; tanzu package installed get tap -n tap-install
NAME:                    tap
PACKAGE-NAME:            tap.tanzu.vmware.com
PACKAGE-VERSION:         1.1.0
STATUS:                  Reconcile succeeded
CONDITIONS:              [{ReconcileSucceeded True  }]
USEFUL-ERROR-MESSAGE:
</code></pre>

<h2 id="hostnames">Hostnames</h2>

<p>Depending on the profile in use, there may be many hostnames needed to be added to the Windows hosts file. Here’s a list of hostnames I use.</p>

<blockquote>
  <p>NOTE: I’m a big fan of our <a href="https://docs.vmware.com/en/Tanzu-Application-Platform/1.1/tap/GUID-learning-center-about.html">Learning Center</a> tool, more about that in future posts I’m sure, so many of these hostnames are related to that project, which is part of TAP. If you don’t deploy it, then you won’t need these hostnames. It is part of the “full” profile though. That said, you can exclude packages from deployment.</p>
</blockquote>

<pre><code>192.168.0.10 tap-gui.example.com tanzu-java-web-app.default.apps.example.com learning-center-guided.lc.example.com learning-center-guided-w01-s001.lc.example.com tanzu-java-web-app-default.apps.example.com learning-center-guided-w01-s001-editor.lc.example.com learning-center-guided-w01-s001-console.lc.example.com learning-center-guided-w01-s001-nginx.lc.example.com learning-center-guided-w01-s001-nginx-via-proxy.lc.example.com learning-center-guided-w01-s001-registry.lc.example.com
</code></pre>

<h2 id="deploying-an-application-aka-workload">Deploying an Application (AKA WOrkload)</h2>

<p>Using the Tanzu CLI, which itself is using Kubernetes under the hood (you could simply use the YAML that it shows as well) we can deploy a Java application.</p>

<blockquote>
  <p>NOTE: We are not building or managing the container image. A TAP component called the Tanzu Build Service is doing that for us. So no Dockerfiles to manage.</p>
</blockquote>

<blockquote>
  <p>NOTE: Ensure you prepare the dev namespace as per the TAPonLAP document.</p>
</blockquote>

<p>E.g. command. Note that I’m just using the default namespace.</p>

<pre><code>$Env:TAP_DEV_NAMESPACE = "default"
tanzu apps workload create tanzu-java-web-app `
  --git-repo https://github.com/sample-accelerators/tanzu-java-web-app `
  --git-branch main `
  --type web `
  --label app.kubernetes.io/part-of=tanzu-java-web-app `
  --label tanzu.app.live.view=true `
  --label tanzu.app.live.view.application.name=tanzu-java-web-app `
  --annotation autoscaling.knative.dev/minScale=1 `
  --namespace $env:TAP_DEV_NAMESPACE `
  --dry-run
</code></pre>

<p>E.g. output of that command:</p>

<pre><code>PS C:\Windows\system32&gt; tanzu apps workload create tanzu-java-web-app `
&gt;&gt;   --git-repo https://github.com/sample-accelerators/tanzu-java-web-app `
&gt;&gt;   --git-branch main `
&gt;&gt;   --type web `
&gt;&gt;   --label app.kubernetes.io/part-of=tanzu-java-web-app `
&gt;&gt;   --label tanzu.app.live.view=true `
&gt;&gt;   --label tanzu.app.live.view.application.name=tanzu-java-web-app `
&gt;&gt;   --annotation autoscaling.knative.dev/minScale=1 `
&gt;&gt;   --namespace $env:TAP_DEV_NAMESPACE `
&gt;&gt;   --yes
Create workload:
←[32m      1 + |---
←[0m←[32m      2 + |apiVersion: carto.run/v1alpha1
←[0m←[32m      3 + |kind: Workload
←[0m←[32m      4 + |metadata:
←[0m←[32m      5 + |  labels:
←[0m←[32m      6 + |    app.kubernetes.io/part-of: tanzu-java-web-app
←[0m←[32m      7 + |    apps.tanzu.vmware.com/workload-type: web
←[0m←[32m      8 + |    tanzu.app.live.view: "true"
←[0m←[32m      9 + |    tanzu.app.live.view.application.name: tanzu-java-web-app
←[0m←[32m     10 + |  name: tanzu-java-web-app
←[0m←[32m     11 + |  namespace: default
←[0m←[32m     12 + |spec:
←[0m←[32m     13 + |  params:
←[0m←[32m     14 + |  - name: annotations
←[0m←[32m     15 + |    value:
←[0m←[32m     16 + |      autoscaling.knative.dev/minScale: "1"
←[0m←[32m     17 + |  source:
←[0m←[32m     18 + |    git:
←[0m←[32m     19 + |      ref:
←[0m←[32m     20 + |        branch: main
←[0m←[32m     21 + |      url: https://github.com/sample-accelerators/tanzu-java-web-app
←[0m
←[32;1mCreated workload "tanzu-java-web-app"
←[0m
</code></pre>

<p>Above you can see that the command displays the YAML that is actually deployed into Kubernetes. Note the kind.</p>

<pre><code>kind: Workload
</code></pre>

<p>With this command or a few lines of YAML, you can completely manage an application in Kubernetes, from source to running application.</p>

<h2 id="the-application-is-deployed">The Application is Deployed!</h2>

<p>The example Java application has now been deployed.</p>

<blockquote>
  <p>NOTE: By default the application is running in <a href="https://knative.dev/docs/">knative</a>, which can scale to zero. But, in the above command we told knative that the minimum scale is 1, ie. not to scale to zero, so there will always be at least one pod running.</p>
</blockquote>

<pre><code>PS C:\Windows\system32&gt; kubectl get pods
NAME                                                   READY   STATUS      RESTARTS   AGE
tanzu-java-web-app-00001-deployment-7fffdb9fcb-2s47s   2/2     Running     0          17m
tanzu-java-web-app-build-1-build-pod                   0/1     Completed   0          19m
tanzu-java-web-app-config-writer-69xhb-pod             0/1     Completed   0          18m
</code></pre>

<p>If we get the routes we can see the URL to connect to.</p>

<pre><code>PS C:\Windows\system32&gt; kubectl get routes
NAME                 URL                                                  READY   REASON
tanzu-java-web-app   http://tanzu-java-web-app-default.apps.example.com   True
</code></pre>

<p>Curl it:</p>

<pre><code>PS C:\Windows\system32&gt; curl.exe http://tanzu-java-web-app-default.apps.example.com
Greetings from Spring Boot + Tanzu!
</code></pre>

<p>Done (for now)!</p>

<h2 id="observe-in-the-tap-gui">Observe in the TAP GUI</h2>

<p>TAP comes with a web GUI, which can be found at http://tap-gui.example.com if using the above “full” profile.</p>

<p><img src="/img/tap-on-lap-gui.jpg" alt="TAP GUI" /></p>

<p>We can start to “drill down” into the running application as well.</p>

<p><img src="/img/tap-on-lap-gui2.jpg" alt="TAP GUI 2" /></p>

<p>We can also visualize our secure software flow, the secure supply chains that were created by default.</p>

<p><img src="/img/tap-on-lap-gui3.jpg" alt="TAP GUI 3" /></p>

<p>Above we are using the default “source-to-url” supply chain.</p>

<pre><code>PS C:\Windows\system32&gt; kubectl get clustersupplychains
NAME                 READY   REASON   AGE
basic-image-to-url   True    Ready    29m
source-to-url        True    Ready    29m
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>TAP, and its modular components, are meant to run in many places in many ways, from large clusters, to minikube instances. If TAP is running locally, then the developer can use it to “iterate” on code: to write code, try deploying it, test it out, understand a bit about TAP, and then commit their code at which point TAP can again take over and build the image and run it in production, but of course, not locally, instead on a production Kubernetes cluster (or, more likely, cluster<strong>s</strong>).</p>

<p>This post just brings us through a bit of TAP, gives a few hints, and provides a starting point to understand more about the TAP paradigm.</p>

<h2 id="extra-notes">Extra Notes</h2>

<h3 id="dont-forget-to-run-the-minikube-tunnel">Don’t Forget to Run the Minikube Tunnel</h3>

<p>If you forget the below…</p>

<pre><code>minikube tunnel
</code></pre>

<p>or didn’t leave it running while installing TAP, then the Ingress load balancer will stay pending and TAP won’t deploy completely.</p>

<h3 id="kubeconfig-into-wsl">Kubeconfig into WSL</h3>

<p>This might not be the right motion, but I prefer to use Linux to work with Kubernetes as opposed to a powershell…er shell. So here I send the kubeconfig for minikube into my WSL users kube config.</p>

<blockquote>
  <p>NOTE: This would, of course, destroy anything existing in your kubeconfig.</p>
</blockquote>

<blockquote>
  <p>NOTE: This assumes your WSL instance is named “Ubuntu” and that your user’s name is “curtis” which is unlikely. :)</p>
</blockquote>

<pre><code>PS C:\Windows\system32&gt; kubectl config view --flatten &gt; \\wsl$\Ubuntu\home\curtis\.kube\config
</code></pre>

<h3 id="minikube-ip">Minikube IP</h3>

<p>One thing I’ve noticed is that the minikube IP will changed, say on a Windows OS reboot. So if that happens you’ll need to change the IP in the hosts file.</p>

<h3 id="minikube-purge">Minikube Purge</h3>

<p>I’ve had to purge the minikube instance once or twice. For some reason, I had one instance of minikube that was acting very slow. I didn’t take the time to try to figure out why it was acting slow. I don’t believe it was because of TAP, more likely because of some storage/disk issue.</p>

<pre><code>PS C:\Windows\system32&gt; minikube delete --purge
</code></pre>

<h3 id="memory-usage">Memory Usage</h3>

<p>So far it seems reasonable to run this on my desktop, though again, most of the time one would run a lighter TAP profile than the “full” profile.</p>

<p><img src="/img/tap-on-lap-4.jpg" alt="Performance" /></p>

</article>
            </main>

            <footer class="mt-12 py-4 text-center text-xs text-gray-500 border-t font-light">
                <p>&copy; 2025 Server As Code Dot Com. All rights reserved.</p>
            </footer>

            <div class="issue-number-large">
                263
            </div>
        </div>
    </div>

<!-- Prism.js for syntax highlighting -->
<script src="/assets/js/prism.min.js"></script>
<script>
    // This script should be placed after the Prism.js script
    if (Prism.plugins && Prism.plugins.NormalizeWhitespace) {
        Prism.plugins.NormalizeWhitespace.setDefaults({
            'remove-trailing': true,
            'remove-indent': true,
            'left-trim': true,
            'right-trim': true
        });
    }

    // NOTE(curtis): None of the ``` in my posts had a language specified, so I'm setting it to bash by default
    Prism.highlightAll = (function (originalHighlightAll) {
        return function () {
            // For block code
            document.querySelectorAll('pre code:not([class*="language-"])')
                .forEach(function(element) {
                    element.classList.add('language-bash');
                });

            // For inline code
            document.querySelectorAll('code:not([class*="language-"]):not(pre code)')
                .forEach(function(element) {
                    element.classList.add('language-bash');
                    element.classList.add('inline-code');
                });

            originalHighlightAll.apply(this, arguments);
        }
    })(Prism.highlightAll);

    // NOTE(curtis): This is a custom function to highlight inline code as Prism doesn't do it by default
    function highlightInlineCode() {
        document.querySelectorAll('code.inline-code').forEach((block) => {
            Prism.highlightElement(block);
        });
    }

    // Re-run Prism highlighting after the page loads
    document.addEventListener('DOMContentLoaded', (event) => {
        Prism.highlightAll();
        highlightInlineCode();
    });

    // Table of Contents Generator
    document.addEventListener('DOMContentLoaded', function() {
        const article = document.querySelector('article.prose');
        if (!article) return;

        // Get all headers from the article content (h2-h4), excluding those in tables
        const headers = Array.from(article.querySelectorAll('h2, h3, h4')).filter(header => {
            // Exclude headers in tables, TOC itself, and any header containing "Table of Contents"
            return !header.closest('table') && 
                   !header.closest('.toc') && 
                   header.textContent.trim() !== 'Table of Contents' &&
                   !header.textContent.includes('Table of Contents');
        });

        // Only generate TOC if there are more than 3 headers
        if (headers.length <= 3) return;

        // Create and initialize TOC container
        const tocContainer = createTOCContainer();
        tocContainer.id = 'toc-container';
        
        // Generate TOC content
        const { toc, sectionInfo } = generateTOCContent(headers);
        
        // Add TOC to container
        tocContainer.appendChild(toc);
        
        // Insert TOC in the appropriate location
        insertTOC(article, tocContainer);

        // Create floating button container
        const floatingContainer = document.createElement('div');
        floatingContainer.className = 'floating-container prose mx-auto text-center mt-8 mb-4';
        floatingContainer.style.cssText = `
            width: 100%;
            max-width: 65ch;
        `;

        // Create the button
        const backButton = document.createElement('button');
        backButton.textContent = '↑ Back to Contents';
        backButton.className = 'bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg hover:bg-gray-700 transition-all duration-200';
        backButton.style.cssText = `
            font-size: 0.875rem;
        `;

        floatingContainer.appendChild(backButton);
        article.appendChild(floatingContainer);

        // Scroll back to TOC when clicked
        backButton.addEventListener('click', () => {
            tocContainer.scrollIntoView({ behavior: 'smooth' });
        });

        // Enable smooth scrolling
        document.documentElement.style.scrollBehavior = 'smooth';
    });

    function createTOCContainer() {
        const container = document.createElement('div');
        container.className = 'toc mb-8 p-4 bg-gray-50 rounded-lg not-prose';
        container.innerHTML = '<h2 class="toc-title text-lg font-semibold mb-2">Table of Contents</h2>';
        return container;
    }

    function generateTOCContent(headers) {
        const toc = document.createElement('ul');
        toc.className = 'space-y-2';
        
        let sectionCount = 1;
        let subsectionCount = 1;
        let lastLevel = 2; // Start with h2 level

        headers.forEach((header, index) => {
            // Ensure header has an ID
            if (!header.id) {
                header.id = `section-${index}`;
            }

            const level = parseInt(header.tagName.charAt(1));
            const { sectionNumber, newSectionCount, newSubsectionCount, newLastLevel } = 
                generateSectionNumber(level, sectionCount, subsectionCount, lastLevel);

            // Update counters
            sectionCount = newSectionCount;
            subsectionCount = newSubsectionCount;
            lastLevel = newLastLevel;

            // Create TOC item
            const item = createTOCItem(header, level, sectionNumber);
            toc.appendChild(item);

            // Update header in content
            header.prepend(document.createTextNode(sectionNumber));
        });

        return { 
            toc,
            sectionInfo: { sectionCount, subsectionCount, lastLevel }
        };
    }

    function generateSectionNumber(level, sectionCount, subsectionCount, lastLevel) {
        let sectionNumber = '';
        let newSectionCount = sectionCount;
        let newSubsectionCount = subsectionCount;
        let newLastLevel = lastLevel;

        if (level === 2) {
            sectionNumber = `${sectionCount}. `;
            newSubsectionCount = 1;
            newSectionCount++;
            newLastLevel = 2;
        } else if (level === 3) {
            sectionNumber = `${sectionCount - 1}.${subsectionCount}. `;
            newSubsectionCount++;
            newLastLevel = 3;
        }

        return {
            sectionNumber,
            newSectionCount,
            newSubsectionCount,
            newLastLevel
        };
    }

    function createTOCItem(header, level, sectionNumber) {
        const item = document.createElement('li');
        const link = document.createElement('a');
        
        link.href = `#${header.id}`;
        link.textContent = sectionNumber + header.textContent;
        link.className = 'text-gray-700 hover:text-gray-900 hover:underline block';

        // Add indentation based on header level
        const indent = level - 2;
        item.style.paddingLeft = `${indent * 1}rem`;
        item.appendChild(link);

        return item;
    }

    function insertTOC(article, tocContainer) {
        const header = article.querySelector('header');
        if (header) {
            header.parentNode.insertBefore(tocContainer, header.nextSibling);
        } else {
            article.insertBefore(tocContainer, article.firstChild);
        }
    }
</script>
<script>
    const backgrounds = [
        '/img/background/background.png',
        '/img/background/background2.png',
        '/img/background/background3.png'
    ];
    const randomBackground = backgrounds[Math.floor(Math.random() * backgrounds.length)];
    document.body.style.backgroundImage = `url('${randomBackground}')`;
    document.body.style.backgroundRepeat = 'repeat';
</script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        const dropdownToggle = document.querySelector('.dropdown-toggle');
        const dropdownMenu = document.querySelector('.dropdown-menu');

        if (!dropdownToggle || !dropdownMenu) {
            console.error('Dropdown elements not found');
            return;
        }

        dropdownToggle.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdownMenu.classList.toggle('show');
        });

        // Close the dropdown if the user clicks outside of it
        window.addEventListener('click', function(event) {
            if (!event.target.matches('.dropdown-toggle')) {
                if (dropdownMenu.classList.contains('show')) {
                    dropdownMenu.classList.remove('show');
                }
            }
        });

        // Handle all links in the dropdown menu
        document.querySelectorAll('.dropdown-menu a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                dropdownMenu.classList.remove('show');

                const href = this.getAttribute('href');
                
                // Check if it's an external link or the feed.xml
                if (href.startsWith('http') || href.startsWith('https') || href === '/feed.xml') {
                    window.open(href, '_blank');
                    return;
                }

                // Check if it's the home or archive link
                if (href === '/' || href === '/archive.html') {
                    window.location.href = href;
                    return;
                }

                const isHomePage = window.location.pathname === '/' || window.location.pathname === '/index.html';
                
                if (isHomePage && href.includes('#')) {
                    // If on home page and it's a section link, smooth scroll
                    const targetId = href.split('#')[1];
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                    }
                } else {
                    // If on another page or it's not a section link, navigate to the page
                    window.location.href = href;
                }
            });
        });
    });

    // Function to scroll to section after page load
    function scrollToSection() {
        const hash = window.location.hash;
        if (hash) {
            const targetElement = document.quefrySelector(hash);
            if (targetElement) {
                setTimeout(() => {
                    targetElement.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            }
        }
    }

    // Call scrollToSection after page load
    window.addEventListener('load', scrollToSection);
</script>

</body>
</html>